- alias: garage motion on
  trigger:
    platform: state
    entity_id: binary_sensor.garage_motion_sensor
    to: 'on'
  action:
    service: homeassistant.turn_on
    entity_id: switch.garage_light
- alias: garage motion off
  trigger:
    platform: state
    entity_id: binary_sensor.garage_motion_sensor
    to: 'off'
  action:
    service: homeassistant.turn_off
    entity_id: switch.garage_light
- alias: door left unlocked
  trigger:
    platform: state
    entity_id: lock.front_door_lock, lock.back_door_lock
    state: 'unlocked'
    for:
      minutes: 2
  action:
    - service: notify.notify
      data_template:
        message: '{{ trigger.to_state.name }} left {{ trigger.to_state.state }} for 2 minutes!'
    - service: logbook.log
      data_template:
        name: '{{ trigger.to_state.name }}'
        entity_id: '{{ trigger.to_state.entity_id }}'
        message: ' left {{ trigger.to_state.state }} for 2 minutes!'
- alias: cover left open
  trigger:
    platform: state
    entity_id: cover.gate
    state: 'open'
    for:
      minutes: 2
  action:
    - service: notify.notify
      data_template:
        message: '{{ trigger.to_state.name }} left {{ trigger.to_state.state }} for 2 minutes!'
    - service: logbook.log
      data_template:
        name: '{{ trigger.to_state.name }}'
        entity_id: '{{ trigger.to_state.entity_id }}'
        message: ' left {{ trigger.to_state.state }} for 2 minutes!'
- alias: mailbox motion
  trigger:
    platform: state
    entity_id: binary_sensor.mailbox_closed_sensor
    to: 'off'
  action:
    - service: notify.notify
      data_template:
        message: "You've got mail!"
    - service: logbook.log
      data_template:
        message: "You've got mail!"
- alias: mailbox left open
  trigger:
    platform: state
    entity_id: binary_sensor.mailbox_closed_sensor
    state: 'off'
    for:
      minutes: 2
  action:
    - service: notify.notify
      data_template:
        message: 'Mailbox left open!'
    - service: logbook.log
      data_template:
        message: 'Mailbox left open!'
- alias: sunset lights on
  trigger:
    platform: sun
    event: sunset
    offset: '-00:30:00'
  action:
    service: homeassistant.turn_on
    entity_id: switch.front_porch_light, light.living_room_lamp
- alias: late night lights off
  trigger:
    platform: time
    after: '00:00:00'
  action:
    service: homeassistant.turn_off
    entity_id: light.living_room_lamp
- alias: sunrise lights off
  trigger:
    platform: sun
    event: sunrise
  action:
    service: homeassistant.turn_off
    entity_id: switch.front_porch_light
- alias: phone low battery
  trigger:
    platform: numeric_state
    entity_id: group.all_devices
    below: 25
  action:
    - service: notify.notify
      data_template:
        message: '{{ trigger.to_state.name }} is {{ trigger.to_state.state }}{{ trigger.to_state.attributes.unit_of_measurement }}.'
    - service: logbook.log
      data_template:
        name: '{{ trigger.to_state.name }}'
        entity_id: '{{ trigger.to_state.entity_id }}'
        message: ' is {{ trigger.to_state.state }}{{ trigger.to_state.attributes.unit_of_measurement }}.'
- alias: freezer temp alert
  trigger:
    platform: numeric_state
    entity_id: sensor.deep_freezer_temp, sensor.freezer_temp
    above: 20
  action:
    - service: notify.notify
      data_template:
        message: '{{ trigger.to_state.name }} is {{ trigger.to_state.state }}{{ trigger.to_state.attributes.unit_of_measurement }}.'
    - service: logbook.log
      data_template:
        name: '{{ trigger.to_state.name }}'
        entity_id: '{{ trigger.to_state.entity_id }}'
        message: ' is {{ trigger.to_state.state }}{{ trigger.to_state.attributes.unit_of_measurement }}.'
- alias: fridge temp alert
  trigger:
    platform: numeric_state
    entity_id: sensor.drink_fridge_temp
    above: 50
  action:
    - service: notify.notify
      data_template:
        message: '{{ trigger.to_state.name }} is {{ trigger.to_state.state }}{{ trigger.to_state.attributes.unit_of_measurement }}.'
    - service: logbook.log
      data_template:
        name: '{{ trigger.to_state.name }}'
        entity_id: '{{ trigger.to_state.entity_id }}'
        message: ' is {{ trigger.to_state.state }}{{ trigger.to_state.attributes.unit_of_measurement }}.'
- alias: thermostat home mode
  trigger:
    platform: state
    entity_id: group.all_devices
    from: 'not_home'
    to: 'home'
  condition:
    condition: template
    value_template: "{{ is_state_attr('climate.downstairs', 'away_mode', 'on') or is_state_attr('climate.upstairs', 'away_mode', 'on') }}"
  action:
    - service: climate.set_away_mode
      data:
        away_mode: 'False'
    - service: notify.notify
      data_template:
        message: 'Thermostat away mode disabled.'
#- alias: location change
#  trigger:
#    platform: state
#    entity_id: device_tracker.cindy_phone, device_tracker.bryce_phone
#  condition:
#    condition: template
#    value_template: '{{ trigger.from_state.state != trigger.to_state.state }}'
#  action:
#    service: logbook.log
#    data_template:
#      name: '{{ trigger.to_state.name }}'
#      entity_id: '{{ trigger.to_state.entity_id }}'
#      #domain: light
#      message: >
#        is
#        {%- if trigger.to_state.state == 'home' %}
#        home
#        {%- elif trigger.to_state.state == 'not_home' %}
#        away
#        {%- else %}
#        at {{ trigger.to_state.state|replace('_',' ') }}
#        {%- endif %}
#      message: "{{ trigger.to_state.name }} is {%if trigger.to_state.state == 'home' %}home{%elif trigger.to_state.state == 'not_home' %}away{% else %}at {{ trigger.to_state.state|replace('_',' ') }} {% endif %}"
